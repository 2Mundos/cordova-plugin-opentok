// Generated by CoffeeScript 1.6.3
(function() {
  var log, session, subscribeToStreams;

  session = {};

  log = function(a) {
    return console.log(a);
  };

  subscribeToStreams = function(streams) {
    var e, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = streams.length; _i < _len; _i++) {
      e = streams[_i];
      _results.push(session.subscribe(e));
    }
    return _results;
  };

  window.startTest = function(apiKey, sessionId, token) {
    var publisher;
    publisher = TB.initPublisher(1127, "myPublisherDiv", {
      width: 400,
      height: 300
    });
    session = TB.initSession(sessionId);
    session.on('streamCreated', function(event) {
      log("streamCreated, logging event");
      log(event);
      return session.subscribe(event.stream);
    });
    session.on('sessionConnected', function(event) {
      log("sessionConnected, logging streams");
      log(event);
      session.publish(publisher);
      return subscribeToStreams(event.streams);
    });
    return session.on("streamCreated", session.connect(apiKey, token));
  };

  window.Cordova = {};

  Cordova.exec = function(a, b, c, d, e) {
    return log("executing " + d + " with params " + e);
  };

}).call(this);
